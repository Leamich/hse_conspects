$p, q$ — простые, получ. т. Люка, т.е. $p-1, q-1$ имеют маленькие простые в разложении.

$N=p\cdot q$

Как, зная это, разложить $N$?

$a \in \mathbb{N}$

$$
\begin{gathered}
ord_{p}(a)=p_{1}^{b_{1}}\dots p_{k}^{b_{k}}\\
or d_{q}(a)=p_{1}^{c_{1}}\dots p_{k}^{c_{k}}
\end{gathered}
$$
$$
\begin{gathered}
A = \min \{ x: x! \;\vdots\; or d_{p}(a) \}\\
B = \min \{ x: x! \;\vdots\; or d_{q}(a) \}
\end{gathered} \implies \text{A и B не оч. большие, скор. всего } A\ne B
$$
Враг считает $d_{k}=(a^{k!}-1, N)$

НУО $A<B$

тогда $d_{A}=p \implies q = \frac{N}{p}$ — взломано. 